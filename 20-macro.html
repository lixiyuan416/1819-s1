


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://www.comp.nus.edu.sg/~ooiwt/cs1010/1819s1/20-macro.html">
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.3">
    
    
      
        <title>20. C Pre-processing - CS1010 Programming Methodology</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.62d34fff.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gentium+Book+Basic">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
    
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unit-20-c-preprocessor-constants-and-macros" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://www.comp.nus.edu.sg/~ooiwt/cs1010/1819s1" title="CS1010 Programming Methodology" class="md-header-nav__button md-logo" aria-label="CS1010 Programming Methodology">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            CS1010 Programming Methodology
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              20. C Pre-processing
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.comp.nus.edu.sg/~ooiwt/cs1010/1819s1" title="CS1010 Programming Methodology" class="md-nav__button md-logo" aria-label="CS1010 Programming Methodology">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    CS1010 Programming Methodology
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="midterm.html" title="Midterm" class="md-nav__link">
      Midterm
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Practical Exams
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Practical Exams" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Practical Exams
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="pe1.html" title="Info About PE1" class="md-nav__link">
      Info About PE1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="pe1-comments.html" title="PE1 Comments and Answers" class="md-nav__link">
      PE1 Comments and Answers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="pe2.html" title="Info About PE2" class="md-nav__link">
      Info About PE2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="pe2-comments.html" title="PE2 Comments and Answers" class="md-nav__link">
      PE2 Comments and Answers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      General
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="General" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        General
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="about.html" title="About CS1010" class="md-nav__link">
      About CS1010
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="outcomes.html" title="Learning Outcomes" class="md-nav__link">
      Learning Outcomes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="schedule.html" title="Schedule" class="md-nav__link">
      Schedule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="accounts.html" title="Accounts" class="md-nav__link">
      Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="policies.html" title="Policies" class="md-nav__link">
      Policies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Notes
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Notes" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="01-program.html" title="1. What is a Program?" class="md-nav__link">
      1. What is a Program?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="02-algo.html" title="2. Computational Problem & Algorithms" class="md-nav__link">
      2. Computational Problem &amp; Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="03-func.html" title="3. Functions" class="md-nav__link">
      3. Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="04-type.html" title="4. Types" class="md-nav__link">
      4. Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="05-first-c.html" title="5. First C Program" class="md-nav__link">
      5. First C Program
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="06-cs1010-io.html" title="6. CS1010 I/O Library" class="md-nav__link">
      6. CS1010 I/O Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="07-arithmetic-ops.html" title="7. Arithmetic Operations" class="md-nav__link">
      7. Arithmetic Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="08-if-else.html" title="8. If Else" class="md-nav__link">
      8. If Else
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="09-logical-exp.html" title="9. Logical Expression" class="md-nav__link">
      9. Logical Expression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="10-assert.html" title="10. Assertion" class="md-nav__link">
      10. Assertion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="11-loop.html" title="11. Loops" class="md-nav__link">
      11. Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="12-invariant.html" title="12. Reasoning About Loops" class="md-nav__link">
      12. Reasoning About Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="13-call-stack.html" title="13. Call Stack" class="md-nav__link">
      13. Call Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="14-pointers.html" title="14. Pointers" class="md-nav__link">
      14. Pointers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="15-array.html" title="15. Arrays" class="md-nav__link">
      15. Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="16-string.html" title="16. Strings" class="md-nav__link">
      16. Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="17-call-by-reference.html" title="17. Call by Reference" class="md-nav__link">
      17. Call by Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="18-heap.html" title="18. Heap" class="md-nav__link">
      18. Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="19-md-array.html" title="19. Multidimensional Array" class="md-nav__link">
      19. Multidimensional Array
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        20. C Pre-processing
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="20-macro.html" title="20. C Pre-processing" class="md-nav__link md-nav__link--active">
      20. C Pre-processing
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#include" class="md-nav__link">
    #include
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-constant" class="md-nav__link">
    #define Constant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-macro" class="md-nav__link">
    #define Macro
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pitfalls-and-best-practices" class="md-nav__link">
    Pitfalls and Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-set-20" class="md-nav__link">
    Problem Set 20
  </a>
  
    <nav class="md-nav" aria-label="Problem Set 20">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-201" class="md-nav__link">
    Problem 20.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-202" class="md-nav__link">
    Problem 20.2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="21-assert.html" title="21. Assert" class="md-nav__link">
      21. Assert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="22-efficiency.html" title="22. Efficiency" class="md-nav__link">
      22. Efficiency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="23-search.html" title="23. Binary Search" class="md-nav__link">
      23. Binary Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="24-sort.html" title="24. Sorting" class="md-nav__link">
      24. Sorting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="25-tower.html" title="25. Tower of Hanoi" class="md-nav__link">
      25. Tower of Hanoi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="26-permutation.html" title="26. Permutation" class="md-nav__link">
      26. Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="27-queens.html" title="27. N Queens" class="md-nav__link">
      27. N Queens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="28-struct.html" title="28. Structure" class="md-nav__link">
      28. Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="29-stdio.html" title="29. stdio" class="md-nav__link">
      29. stdio
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Exercises
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Exercises" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Exercises
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="ex01.html" title="1. Freezer" class="md-nav__link">
      1. Freezer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ex02.html" title="2. Leap, Suffix, Days" class="md-nav__link">
      2. Leap, Suffix, Days
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ex03.html" title="3. Binary, Rectangle, Fibonacci, Prime" class="md-nav__link">
      3. Binary, Rectangle, Fibonacci, Prime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ex04.html" title="4. ID, Grade, Index, Max" class="md-nav__link">
      4. ID, Grade, Index, Max
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ex05.html" title="5. Square, Escape, Magic" class="md-nav__link">
      5. Square, Escape, Magic
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Assignments
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Assignments" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Assignments
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="assignment.html" title="General Guide" class="md-nav__link">
      General Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as01.html" title="1. Invest, Box, Digits, and Taxi" class="md-nav__link">
      1. Invest, Box, Digits, and Taxi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as01-comments.html" title="1. Comments and Answer Keys" class="md-nav__link">
      1. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as02.html" title="2. Collatz, Weekday, Circle, Pattern" class="md-nav__link">
      2. Collatz, Weekday, Circle, Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as02-comments.html" title="2. Comments and Answer Keys" class="md-nav__link">
      2. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as03.html" title="3. Kendall, Histogram, CountingSort" class="md-nav__link">
      3. Kendall, Histogram, CountingSort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as03-comments.html" title="3. Comments and Answer Keys" class="md-nav__link">
      3. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as04.html" title="4. SelectionSort, Add, Mastermind" class="md-nav__link">
      4. SelectionSort, Add, Mastermind
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as04-comments.html" title="4. Comments and Answer Keys" class="md-nav__link">
      4. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as05.html" title="5. Social, Life" class="md-nav__link">
      5. Social, Life
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as05-comments.html" title="5. Comments and Answer Keys" class="md-nav__link">
      5. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as06.html" title="6. Permutation 1 2 3" class="md-nav__link">
      6. Permutation 1 2 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as06-comments.html" title="6. Comments and Answer Keys" class="md-nav__link">
      6. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as07.html" title="7. Peak, Scripts, Inversion" class="md-nav__link">
      7. Peak, Scripts, Inversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as07-comments.html" title="7. Comments and Answer Keys" class="md-nav__link">
      7. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as08.html" title="8. Maze, Fill" class="md-nav__link">
      8. Maze, Fill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as08-comments.html" title="8. Comments and Answer Keys" class="md-nav__link">
      8. Comments and Answer Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as09.html" title="9. Digits" class="md-nav__link">
      9. Digits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="as09-comments.html" title="9. Comments and Answer Keys" class="md-nav__link">
      9. Comments and Answer Keys
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="quiz.html" title="Quizzes" class="md-nav__link">
      Quizzes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Kahoot!
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Kahoot!" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Kahoot!
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="kahoot01.html" title="Flow Charts" class="md-nav__link">
      Flow Charts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="c-in-cs1010.html" title="C in CS1010" class="md-nav__link">
      C in CS1010
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="style.html" title="Style Guide" class="md-nav__link">
      Style Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="documentation.html" title="Documentation Guide" class="md-nav__link">
      Documentation Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="readings.html" title="Readings" class="md-nav__link">
      Readings
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Software/Tools
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Software/Tools" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Software/Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="environments.html" title="Programming Environments" class="md-nav__link">
      Programming Environments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="unix.html" title="UNIX" class="md-nav__link">
      UNIX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="clang.html" title="CLang" class="md-nav__link">
      CLang
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="vim.html" title="Vim" class="md-nav__link">
      Vim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="lldb.html" title="LLDB" class="md-nav__link">
      LLDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="library.html" title="CS1010 I/O" class="md-nav__link">
      CS1010 I/O
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#include" class="md-nav__link">
    #include
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-constant" class="md-nav__link">
    #define Constant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-macro" class="md-nav__link">
    #define Macro
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pitfalls-and-best-practices" class="md-nav__link">
    Pitfalls and Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-set-20" class="md-nav__link">
    Problem Set 20
  </a>
  
    <nav class="md-nav" aria-label="Problem Set 20">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-201" class="md-nav__link">
    Problem 20.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-202" class="md-nav__link">
    Problem 20.2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="unit-20-c-preprocessor-constants-and-macros">Unit 20: C Preprocessor: Constants and Macros</h1>
<p>In this unit, we are going to delve deeper into the C compilation process, focusing on a step called <em>preprocessing</em>.<br />
This step is usually the first step in the compilation process.</p>
<p>Preprocessing is, in essence, a text processing and substitution process, and so it is not C specific.  This process is used by C to implement, among other things: (i) file inclusion, (ii) macro, and (iii) conditional compilation. </p>
<p>A C preprocessor processes all the lines in the input file that starts with a <em>preprocessor directive</em>.  A directive starts with the letter <code>#</code>.  You have seen two of such directives, <code>#include</code> to include a file, and <code>#define</code> to define a constant.</p>
<h2 id="include"><code>#include</code></h2>
<p>The <code>#include</code> directive has the format</p>
<p><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;filename&gt;</span><span class="cp"></span>
</code></pre></div>
or</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&quot;filename&quot;</span><span class="cp"></span>
</code></pre></div>

<p>When the C preprocessor sees this directive, it reads the file specified by the given filename, and inserts the text, line-by-line, from this file, into the current file, in the location where the line <code>#include</code> occurs.   Any C preprocessor directive in the included file is recursively processed.</p>
<h2 id="define-constant">#define Constant</h2>
<p>We have seen how we can use <code>#define</code> to define constant values in our code in our exercises and assignments.  </p>
<p>We should avoid hardcoding constant values (also called <em>magic numbers</em>) in our code so that our code can be easily changed when the requirement of our program has changed.</p>
<p>Take this code, for instance, from Taxi:</p>
<div class="highlight"><pre><span></span><code><span class="kt">double</span> <span class="nf">metered_fare</span><span class="p">(</span><span class="kt">long</span> <span class="n">distance</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">fare</span> <span class="o">=</span> <span class="mf">3.40</span><span class="p">;</span>

  <span class="n">distance</span> <span class="o">-=</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">9200</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="mf">0.22</span> <span class="o">*</span> <span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="mi">400</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fare</span> <span class="o">+=</span> <span class="mf">0.22</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="mf">0.22</span> <span class="o">*</span> <span class="p">(</span><span class="mi">9200</span> <span class="o">/</span> <span class="mi">400</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">distance</span> <span class="o">-=</span> <span class="mi">9200</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">fare</span> <span class="o">+=</span> <span class="mf">0.22</span> <span class="o">*</span> <span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="mi">350</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">%</span> <span class="mi">350</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="mf">0.22</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>In my answer posted, I have used many hardcoded values.  Suppose one day, the taxi fare changes (and that day will come).  Perhaps the base fare is more, perhaps the distance threshold is shorter.  We will have to change the code above to calculate the new fare.  By littering the code above with hardcoded values, the code is difficult and error-prone to change.  Suppose we rewrite the code as:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define BASE_FARE 3.40</span>
<span class="cp">#define BASE_DISTANCE 1000</span>
<span class="cp">#define TIER_ONE_FARE 0.22</span>
<span class="cp">#define TIER_ONE_DISTANCE 400</span>
<span class="cp">#define TIER_ONE_LIMIT 9200</span>
<span class="cp">#define TIER_TWO_FARE 0.22</span>
<span class="cp">#define TIER_TWO_DISTANCE 350</span>

<span class="kt">double</span> <span class="nf">metered_fare</span><span class="p">(</span><span class="kt">long</span> <span class="n">distance</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">fare</span> <span class="o">=</span> <span class="n">BASE_FARE</span><span class="p">;</span>

  <span class="n">distance</span> <span class="o">-=</span> <span class="n">BASE_DISTANCE</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="n">TIER_ONE_LIMIT</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="n">TIER_ONE_FARE</span> <span class="o">*</span> <span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">TIER_ONE_DISTANCE</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">%</span> <span class="n">TIER_ONE_DISTANCE</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fare</span> <span class="o">+=</span> <span class="n">TIER_ONE_FARE</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="n">TIER_ONE_FARE</span> <span class="o">*</span> <span class="p">(</span><span class="n">TIER_ONE_LIMIT</span> <span class="o">/</span> <span class="n">TIER_ONE_DISTANCE</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">distance</span> <span class="o">-=</span> <span class="n">TIER_ONE_LIMIT</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">fare</span> <span class="o">+=</span> <span class="n">TIER_TWO_FARE</span> <span class="o">*</span> <span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">TIER_TWO_DISTANCE</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">%</span> <span class="n">TIER_TWO_DISTANCE</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fare</span> <span class="o">+=</span> <span class="n">TIER_TWO_FARE</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">fare</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>We have factored out all the hardcoded values into constants we defined.  It does make the code a bit harder to read, but now, it is super easy to change.  Suppose, one day, the base taxi fare is decreased to $3.20, and then $0.20 per 500m subsequently up to 10km, and $0.15 per 600m thereafter, we only need to change:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define BASE_FARE 3.20</span>
<span class="cp">#define BASE_DISTANCE 1000</span>
<span class="cp">#define TIER_ONE_FARE 0.20</span>
<span class="cp">#define TIER_ONE_DISTANCE 500</span>
<span class="cp">#define TIER_ONE_LIMIT 10000</span>
<span class="cp">#define TIER_TWO_FARE 0.15</span>
<span class="cp">#define TIER_TWO_DISTANCE 600</span>
</code></pre></div>

<p>The logic of the code remains the same.   </p>
<p>The <code>#define</code> directive should be followed an <em>identifier</em> and a <em>token</em>.  The token may contain space but must be terminated by a newline.  In the example above, <code>BASE_FARE</code> is the identifier, and <code>3.20</code> is the token.</p>
<p>When the C preprocessor sees the <code>#define</code> directive, it replaces all instances of the identifier in the file with the token.  This is merely a text substitution operation.</p>
<h2 id="example">Example:</h2>
<p>Consider the example below.  Suppose we have three files:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @file: a.c</span>
<span class="cm"> */</span>

<span class="cp">#include</span> <span class="cpf">&quot;b.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">foo</span><span class="p">(</span><span class="n">PI</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @file: b.h</span>
<span class="cm"> */</span>

<span class="cp">#include</span> <span class="cpf">&quot;c.h&quot;</span><span class="cp"></span>
<span class="cp">#define PI 3.1415926</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @file: c.h</span>
<span class="cm"> */</span>

<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">);</span>
</code></pre></div>

<p>Let's see what happen when we run C pre-processor on the file <code>a.c</code>.  We can ask <code>clang</code> to stop the compilation process after the pre-processing phase, using the flag <code>-E</code>.</p>
<div class="highlight"><pre><span></span><code>clang -E a.c
</code></pre></div>

<p>The command will produce the output after C pre-processing:</p>
<div class="highlight"><pre><span></span><code><span class="cp"># 1 &quot;a.c&quot;</span>
<span class="cp"># 1 &quot;&lt;built-in&gt;&quot; 1</span>
<span class="cp"># 1 &quot;&lt;built-in&gt;&quot; 3</span>
<span class="cp"># 360 &quot;&lt;built-in&gt;&quot; 3</span>
<span class="cp"># 1 &quot;&lt;command line&gt;&quot; 1</span>
<span class="cp"># 1 &quot;&lt;built-in&gt;&quot; 2</span>
<span class="cp"># 1 &quot;a.c&quot; 2</span>
<span class="cp"># 1 &quot;./b.h&quot; 1</span>
<span class="cp"># 1 &quot;./c.h&quot; 1</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">);</span>
<span class="cp"># 6 &quot;./b.h&quot; 2</span>
<span class="cp"># 5 &quot;a.c&quot; 2</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">foo</span><span class="p">(</span><span class="mf">3.1415926</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>The lines start with <code>#</code> are metadata meant for the compiler.  If we ignore those, we can see that the file <code>a.c</code> has been expanded into
<div class="highlight"><pre><span></span><code><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">foo</span><span class="p">(</span><span class="mf">3.1415926</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Line 1 above is included from file <code>c.h</code>, which in turn is included from file <code>b.h</code>.  The C pre-processor also substitutes the text <code>PI</code> with the text <code>3.1415926</code>, as the identifier <code>PI</code> is defined in <code>b.h</code>.</p>
<h2 id="define-macro"><code>#define</code> Macro</h2>
<p>The <code>#define</code> directive can be used for a more flexible and powerful text substitution feature called <em>macro</em>.  <em>A macro is a block of code that is given an identifying name and is substituted and expanded during pre-processing.</em></p>
<p>For instance, we can write the following:</p>
<div class="highlight"><pre><span></span><code>#define SQUARE(x) x*x
</code></pre></div>

<p>This macro is named <code>SQUARE</code>, just like a function we defined in Lecture 3 and it takes in a parameter <code>x</code> as well.  But that's where the similarity ends.  There are a few important differences between macros and functions in C:</p>
<ul>
<li>Macros are not called.  They are only substituted during preprocessing phase which performs text processing on the source code.</li>
<li>Macros have no information about types. It has no return type and the parameters have no type.</li>
</ul>
<p>Take the example below.  The file:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SQUARE(x) x*x</span>
<span class="cp">#define PI 3.1415926</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">radius</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">;</span>
  <span class="n">cs1010_print_double</span><span class="p">(</span><span class="n">PI</span><span class="o">*</span><span class="n">SQUARE</span><span class="p">(</span><span class="n">radius</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>

<p>Get expanded into:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">radius</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">;</span>
  <span class="n">cs1010_print_double</span><span class="p">(</span><span class="mf">3.1415926</span><span class="o">*</span><span class="n">radius</span><span class="o">*</span><span class="n">radius</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Let's look at another example.  We have seen how to write a function that swaps two the value of variables.  The one we wrote swaps two <code>double</code>.  If we want to swap two <code>long</code>, or two <code>char *</code>, etc, we will need to write a new function for each one.  </p>
<p>Let's write a generic macro that does swapping for any type.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SWAP(T, x, y) {\</span>
<span class="cp">  T temp;\</span>
<span class="cp">  temp = x;\</span>
<span class="cp">  x = y;\</span>
<span class="cp">  y = temp;\</span>
<span class="cp">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="kt">long</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
  <span class="n">SWAP</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>The macro <code>SWAP</code> takes in three parameters, the first is the type T, the second and the third are the variables to be swapped.  This macro definition spans multiple lines.  Since C preprocessor ends the definition of a macro with the end of the line, we add a backslash character to "escape" the newline, telling the preprocessor not to treat the newline as the end of the macro definition.</p>
<p>The code above gets expanded to:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="kt">long</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
  <span class="p">{</span> <span class="kt">long</span> <span class="n">temp</span><span class="p">;</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;};</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="pitfalls-and-best-practices">Pitfalls and Best Practices</h2>
<p>It is easy to forget that macro is doing simple text substitution without an understanding of C syntax.  When we write macros, we should always guard against improper usage of macros.  Let's consider this:</p>
<p><div class="highlight"><pre><span></span><code><span class="cp">#define SQUARE(x) x*x</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">SQUARE</span><span class="p">(</span><span class="n">radius</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></p>
<p>When the preprocessor substitutes the macro <code>SQUARE</code>, it replaces all instances of the text <code>x</code> with the text <code>radius + 2</code>.  After substitution, we get <code>radius + 2*radius + 2</code>!  This is not what we expected.</p>
<p>To prevent such unexpected expansion, we should always add parenthesis to our macro expression:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SQUARE(x) ((x)*(x))</span>
</code></pre></div>

<p>So now, 
<div class="highlight"><pre><span></span><code>SQUARE(radius + 2)
</code></pre></div></p>
<p>gets expanded into <code>((radius + 2)*(radius + 2))</code>, which is what we would expect when we call <code>SQUARE</code>.</p>
<p>To help the readers of your code know that you are referencing a macro rather than a function, all macros should be written with uppercase letters.</p>
<h2 id="problem-set-20">Problem Set 20</h2>
<h3 id="problem-201">Problem 20.1</h3>
<p>a) Consider the macro below:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define MIN(a,b)  a &lt; b ? a : b</span>

<span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="n">MIN</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="kt">long</span> <span class="n">j</span> <span class="o">=</span> <span class="n">MIN</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div>

<p>What are the values for <code>i</code> and <code>j</code> after executing the above?  </p>
<p>b) </p>
<div class="highlight"><pre><span></span><code><span class="cp">#define MIN(a,b)  a &lt; b ? a : b</span>

<span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">long</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="n">MIN</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">++</span><span class="p">);</span>
</code></pre></div>

<p>What are the values of <code>i</code> and <code>k</code> after executing the above?</p>
<h3 id="problem-202">Problem 20.2</h3>
<p>Suppose we write our <code>SWAP</code> macro without the opening and closing brackets:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SWAP(T, x, y) T temp = x;\</span>
<span class="cp">  x = y;\</span>
<span class="cp">  y = temp;</span>
</code></pre></div>

<p>What could go wrong?</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="19-md-array.html" title="19. Multidimensional Array" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                19. Multidimensional Array
              </div>
            </div>
          </a>
        
        
          <a href="21-assert.html" title="21. Assert" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                21. Assert
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright by Department of Computer Science, National University of Singapore 2018
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.f81b9e8b.min.js"></script>
      <script src="assets/javascripts/bundle.23546af0.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>